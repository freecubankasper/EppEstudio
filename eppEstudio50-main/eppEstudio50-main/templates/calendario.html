{% extends 'baseproyect.html' %}
{% load static %}
{% block content %}

{% block styles %}
    <link href="{% static 'general/bootstrap-sweetalert/sweetalert.css' %}" rel="stylesheet" type="text/css"/>
    <link href="{% static 'fullcalendar/lib/main.css' %}" rel="stylesheet" type="text/css"/>
{% endblock %}
<img src="{% static 'assets/base/img/layout/logos/about.png'%}" alt="Estudio50Habana" class="c-desktop-logo" style="width: 100%;height: 50%">
    <br>    <br>

    <div class="container" style="box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);transition: 0.3s;">
    <h2 style="text-align: center;">{{ proyecto.nombre }}</h2>
    <h3 style="text-align: center;">{{ proyecto.categoria.nombre }}</h3>


    </div><br>
    <div class="container" style="box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);transition: 0.3s;">

            <div id="calendar" class="card" style="padding: 20px">
            </div>

    <div class="modal fade c-content-login-form" id="crear_evento" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content c-square">
            <div class="modal-header c-no-border">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body">
{#                <img src="{% static 'assets/base/img/layout/logos/logo-5negrohabana.png'%}" alt="Estudio50Habana" class="c-desktop-logo" style="max-height: 65px;">#}
{#                <br>#}
                <h3 class="c-font-24 c-font-sbold">Accion</h3>
                <p>Let's make a call</p>
                <form class="kt-form__group" method="GET" action="{% url 'registrar_llamado_proyecto_calendario' proyecto_id %}" id="form_proyecto_call">{% csrf_token %}
                    <div class="form-group">
                        <label style="font-size: medium" for="id_call_nombre" >Call Title</label>
                        <input type="text" id="id_call_nombre" name="id_call_nombre" class="form-control input-sm c-square" placeholder="Call Title">
                    </div>
                    <div class="form-group">
                        <label style="font-size: medium" for="id_call_type" >Call Type</label>
                        <select style="display: block; width: 100%" name="id_call_type" class="form-control input-lg c-square"
                                        title="Select call type" required>
                                    <option value="">Type</option>
                                    <option value="medio_llamado">Medio Llamado</option>
                                    <option value="llamado_completo">Llamado Completo</option>
                                </select>
                    </div>
                    <div class="row">
                    <div class="form-group col-md-6">
                        <label style="font-size: medium" for="id_centro_emergencia" >Emergency Center</label>
                        <input type="text" id="id_centro_emergencia" name="id_centro_emergencia" class="form-control input-sm c-square" placeholder="Emergency Center">
                    </div>

                    <div class="form-group col-md-6">
                        <label style="font-size: medium" for="id_direccion_centro_emergencia" >Emergency Address</label>
                        <input type="text" id="id_direccion_centro_emergencia" name="id_direccion_centro_emergencia" class="form-control input-sm c-square" placeholder="Emergency Center Address">
                    </div>
                    </div>
                    <div class="row">
                    <div class="form-group col-md-6">
                        <label style="font-size: medium" for="id_production_call" >Production Call</label>
                        <input type="datetime-local" class="form-control input-sm c-square" name="id_production_call" id="id_production_call" placeholder="Production Call">
                    </div>
                    <div class="form-group col-md-6">
                        <label style="font-size: medium" for="id_courtesy_meal" >Courtesy Meal</label>
                        <input type="datetime-local" class="form-control input-sm c-square" name="id_courtesy_meal" id="id_courtesy_meal" placeholder="Courtesy Meal">
                    </div>
                        </div>
                    <div class="row">
                    <div class="form-group col-md-6">
                        <label style="font-size: medium" for="id_crew_call" >Crew Call</label>
                        <input type="datetime-local" class="form-control input-sm c-square" name="id_crew_call" id="id_crew_call" placeholder="Crew Call">
                    </div>
                    <div class="form-group col-md-6">
                        <label style="font-size: medium" for="id_artist_call" >Artist Call</label>
                        <input type="datetime-local" class="form-control input-sm c-square" name="id_artist_call" id="id_artist_call" placeholder="Artist Call">
                    </div>
                        </div>
                    <div class="row">
                    <div class="form-group col-md-6">
                        <label style="font-size: medium" for="id_ready_to_shoot" >Ready to Shoot</label>
                        <input type="datetime-local" class="form-control input-sm c-square" name="id_ready_to_shoot" id="id_ready_to_shoot" placeholder="Ready to Shoot">
                    </div>
                    <div class="form-group col-md-6">
                        <label style="font-size: medium" for="id_estimated_camera_wrap" >Camera Wrap</label>
                        <input type="datetime-local" class="form-control input-sm c-square" name="id_estimated_camera_wrap" id="id_estimated_camera_wrap" placeholder="Camera Wrap">
                    </div>
                        </div>
                    <div class="form-group">
                        <label style="font-size: medium" for="id_observaciones" >Observaciones</label>
                        <textarea type="text" id="id_observaciones" name="id_observaciones" class="form-control input-sm c-square" placeholder="Observaciones"></textarea>
                    </div>
                <br>
                        <button type="submit" class="btn c-theme-btn btn-md   c-btn-square c-btn-login" onclick="$('#form_proyecto_call').submit();" style="background: white;color: black;border-color: black;">CREATE CALL</button>
                </form>
            </div>
        </div>
    </div>
</div>
    </div>



{% block scripts %}
    <script src="{% static 'general/block-ui/jquery.blockUI.js' %}" type="text/javascript"></script>
    <script src="{% static 'general/bootstrap-sweetalert/sweetalert.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'general/vendors/js/ui-sweetalert.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'fullcalendar/lib/main.js' %}" type="text/javascript"></script>
    <script src="{% static 'fullcalendar/lib/locales-all.js' %}" type="text/javascript"></script>
    <script src="{% static 'general/bootstrap/dist/js/bootstrap.js' %}" type="text/javascript"></script>

    <script>


        document.addEventListener('DOMContentLoaded', function () {
            var calendarUI = document.getElementById('calendar');

            var calendar = new FullCalendar.Calendar(calendarUI, {

                headerToolbar: {
                    left: 'prev,next',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek,listWeek',
                },

            validRange: {
                        start: "{{ inicio }}",
                        end: "{{ fin }}",
                      },
                views: {
                    dayGridMonth: {
                        displayEventTime: true,
                    },

                },
                events: [
                    {% for evento in eventos %}
                        {
                            id:"{{ evento.id }}",
                            title: "{{ evento.titulo }}",
                            description: "{{ evento.observaciones }}",
                            start: '{{ evento.production_call | date:"Y-m-d H:i"}}',
                            end: '{{ evento.fecha_fin_llamado | date:"Y-m-d H:i"}}',
                            allDay: false


                        },
                    {% endfor %}
                ],
                eventTimeFormat: {
                    hour: '2-digit',
                    minute: '2-digit',
                },
                initialView: 'dayGridMonth',
                eventColor: '#ff0000',
                eventBorderColor: '#000000',
                eventTextColor: '#000000',
                eventOrder: true,
                eventClick: function (info) {
                    var llamado_id= parseInt(info.event.id);
                    console.log(llamado_id)
                    location.href = +llamado_id+"/registrar/";

                    if (info.event.url) {

                        return false;

                    }
                },
                dateClick: function(info) {
                    $("#crear_evento").modal();
                }
            });
            calendar.render();
            calendar.setOption('locale', 'es');
        });
    </script>
{% endblock %}
<br>
{% endblock %}